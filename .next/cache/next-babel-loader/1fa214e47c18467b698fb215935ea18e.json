{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\n\nvar _s = $RefreshSig$(),\n    _topStickyContainer;\n\nvar __jsx = React.createElement;\n\n/** @jsx jsx */\nimport React, { useState, useEffect } from \"react\";\nimport { jsx, Text } from \"theme-ui\";\nimport { loadStripe } from \"@stripe/stripe-js\";\nimport axios from \"axios\";\nimport { toast } from \"react-toastify\";\nimport Lightbox from \"react-image-lightbox\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport CircularProgress from \"@material-ui/core/CircularProgress\";\nimport CustomLoader from \"../CustomLoader\";\nimport Card from \"@material-ui/core/Card\";\nimport CardContent from \"@material-ui/core/CardContent\";\nimport NextTabBtn from \"../NextTabBtn/NextTabBtn\";\nimport ProductSummary from \"./ProductSummary\";\nimport { getIsProduction } from \"../../Lib/getIsProduction\";\nimport { useGetDataPrintful } from \"../../Hooks/useGetDataPrintful\";\nvar STRIPE_PUBLIC_KEY_LIVE = \"pk_live_51IUQiOKQWovk2rIh0SfKkGNuHSE5J7VY6LCJaijjYh7lmjb64h8fmHcYmYoINNCNMTC5sxdsUkwnWIePd2z6vqPH00BzD2UrRm\";\nvar STRIPE_PUBLIC_KEY_TEST = \"pk_test_51IUQiOKQWovk2rIhec8u6qPLKq2TgWI9ZLLkC4jJGIfnV9RV3gi1I5Vk2wmZfRWGCIunxtJgRcBZC8wDBOIstdLL00zZVirE5R\";\nvar Stripe;\nexport default function CheckoutCard(_ref) {\n  _s();\n\n  var _dataPrintful$product, _dataPrintful$product2;\n\n  var product = _ref.product,\n      mapTitles = _ref.mapTitles,\n      isUploadPending = _ref.isUploadPending,\n      setIsUploadPending = _ref.setIsUploadPending,\n      imageSavedResponse = _ref.imageSavedResponse,\n      imageBase64 = _ref.imageBase64,\n      backdropClose = _ref.backdropClose,\n      percentageUpload = _ref.percentageUpload;\n  var classes = useStyles();\n\n  var _useState = useState({\n    open: false,\n    activeSrc: null\n  }),\n      lightbox = _useState[0],\n      setLightbox = _useState[1];\n\n  var _useGetDataPrintful = useGetDataPrintful([product.variantId]),\n      dataPrintful = _useGetDataPrintful.data;\n\n  var IS_PRODUCTION = getIsProduction();\n  var STRIPE_API_KEY = IS_PRODUCTION ? STRIPE_PUBLIC_KEY_LIVE : STRIPE_PUBLIC_KEY_TEST;\n  useEffect(function () {\n    var asyncStripeInit = /*#__PURE__*/function () {\n      var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.next = 2;\n                return StripePromise;\n\n              case 2:\n                Stripe = _context.sent;\n\n              case 3:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }));\n\n      return function asyncStripeInit() {\n        return _ref2.apply(this, arguments);\n      };\n    }();\n\n    var StripePromise = loadStripe(STRIPE_API_KEY);\n    asyncStripeInit();\n  }, []);\n\n  function redirectToCheckout() {\n    return _redirectToCheckout.apply(this, arguments);\n  }\n\n  function _redirectToCheckout() {\n    _redirectToCheckout = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n      var _response$data;\n\n      var response;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.next = 2;\n              return axios.post(\"api/stripe-checkout\", {\n                product: product,\n                imageObj: imageSavedResponse\n              });\n\n            case 2:\n              response = _context2.sent;\n\n              if (response === null || response === void 0 ? void 0 : (_response$data = response.data) === null || _response$data === void 0 ? void 0 : _response$data.id) {\n                Stripe.redirectToCheckout({\n                  sessionId: response.data.id\n                });\n              }\n\n            case 4:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n    return _redirectToCheckout.apply(this, arguments);\n  }\n\n  return jsx(Card, {\n    className: classes.paper,\n    elevation: 3,\n    onClick: function onClick(e) {\n      return e.stopPropagation();\n    }\n  }, jsx(\"div\", {\n    sx: styles.topStickyContainer\n  }, jsx(\"div\", {\n    sx: styles.teaserWrapper\n  }, jsx(\"div\", {\n    sx: styles.white_padding\n  }, isUploadPending ? // <CircularProgress style={{ color: \"primary\" }} />\n  jsx(React.Fragment, null, jsx(CustomLoader, null)) : jsx(\"img\", {\n    id: \"img_screen_shot\",\n    sx: styles.teaserFinalImage,\n    src: imageBase64,\n    onClick: function onClick(e) {\n      setLightbox({\n        open: true,\n        activeSrc: imageBase64\n      });\n      e.stopPropagation();\n    }\n  }))), jsx(\"div\", {\n    sx: styles.picture_description\n  }, jsx(\"p\", {\n    style: {\n      color: \"white\"\n    }\n  }, \" \", percentageUpload, \" %\"), jsx(\"p\", {\n    sx: styles.subName\n  }, isUploadPending ? \"Ukládám design v tiskové kvalitě\" : \"Výsledný design pro tisk (bez rámování)\")), jsx(\"div\", {\n    sx: styles.closeBackdrop\n  }, jsx(\"p\", {\n    onClick: function onClick() {\n      return backdropClose();\n    }\n  }, \"X\"))), jsx(CardContent, {\n    className: classes.content,\n    classes: {\n      root: classes.contentRoot\n    }\n  }, jsx(ProductSummary, {\n    product: product,\n    mapTitles: mapTitles,\n    dataPrintfulVariant: dataPrintful && dataPrintful[product.variantId] // shippingInfoObject={shippingInfoObject}\n    // isShippingInfoLoading={isShippingInfoLoading}\n\n  })), jsx(\"div\", {\n    sx: styles.bottomCtaContainer\n  }, jsx(NextTabBtn, {\n    width: \"90%\",\n    onClick: function onClick() {\n      return redirectToCheckout();\n    },\n    isLoadingOnClick: true,\n    isDisabled: isUploadPending,\n    disabledText: \"Ukládám výsledný design\",\n    price: dataPrintful && eval(\"\".concat((_dataPrintful$product = dataPrintful[product.variantId]) === null || _dataPrintful$product === void 0 ? void 0 : _dataPrintful$product.price, \" + \").concat((_dataPrintful$product2 = dataPrintful[product.variantId]) === null || _dataPrintful$product2 === void 0 ? void 0 : _dataPrintful$product2.shipping.rate)) //TODO add big.js\n\n  }, \"Adresa doru\\u010Den\\xED & platba\")), lightbox.open && jsx(Lightbox, {\n    mainSrc: lightbox.activeSrc,\n    onCloseRequest: function onCloseRequest() {\n      return setLightbox({\n        open: false\n      });\n    }\n  }));\n}\n\n_s(CheckoutCard, \"bJchWY+VlqRMed8vXl8KVcA40nw=\", false, function () {\n  return [useStyles, useGetDataPrintful];\n});\n\n_c = CheckoutCard;\nvar styles = {\n  topStickyContainer: (_topStickyContainer = {\n    position: \"sticky\",\n    top: 0,\n    width: \"100%\",\n    textAlign: \"right\",\n    color: \"white\",\n    zIndex: 10,\n    display: \"flex\"\n  }, _defineProperty(_topStickyContainer, \"width\", \"100%\"), _defineProperty(_topStickyContainer, \"backgroundColor\", \"primary\"), _defineProperty(_topStickyContainer, \"borderBottomLeftRadius\", \"20px\"), _defineProperty(_topStickyContainer, \"borderBottomRightRadius\", \"20px\"), _defineProperty(_topStickyContainer, \"justifyContent\", \"flex-start\"), _defineProperty(_topStickyContainer, \"alignItems\", \"flex-end\"), _defineProperty(_topStickyContainer, \"p\", {\n    display: \"inline-block\",\n    px: \"0.3rem\",\n    borderBottomLeftRadius: \"0.4rem\",\n    cursor: \"pointer\"\n  }), _topStickyContainer),\n  teaserWrapper: {\n    // flexDirection: \"column\",\n    display: \"flex\",\n    justifyContent: \"flex-start\",\n    p: \"10px\",\n    height: \"100px\" //\n\n  },\n  white_padding: {\n    backgroundColor: \"whitish_paper_blue\",\n    display: \"flex\",\n    justifyContent: \"center\",\n    alignItems: \"center\",\n    height: \"80px\",\n    width: \"80px\",\n    position: \"relative\",\n    overflow: \"hidden\",\n    borderRadius: \"10px\"\n  },\n  teaserFinalImage: {\n    height: \"80%\",\n    width: \"80%\",\n    zIndex: 10,\n    margin: \"auto\",\n    cursor: \"pointer\",\n    boxShadow: \"0px 0px 3px rgba(0, 0, 0, 0.56)\"\n  },\n  closeBackdrop: {\n    position: \"absolute\",\n    right: 0,\n    top: 0,\n    p: \"0.3rem\"\n  },\n  picture_description: {\n    pb: \"10px\",\n    display: \"flex\",\n    flexDirection: \"column\",\n    textAlign: \"left\"\n  },\n  subName: {\n    textAlign: \"left\",\n    fontSize: \"0.8rem\"\n  },\n  productName: {\n    fontWeight: 600\n  },\n  productSize: {\n    color: \"grey\"\n  },\n  productDesc: {\n    color: \"grey\"\n  },\n  bottomCtaContainer: {\n    position: \"sticky\",\n    bottom: -1,\n    width: \"100%\",\n    py: \"0.6rem\"\n  }\n};\nvar useStyles = makeStyles(function (theme) {\n  return {\n    backdrop: {\n      zIndex: 10,\n      color: \"#fff\",\n      position: \"relative\"\n    },\n    paper: {\n      minWidth: \"300px\",\n      maxHeight: \"85vh\",\n      overflow: \"scroll\",\n      backgroundColor: \"whitish_paper_blue\"\n    },\n    contentRoot: {\n      paddingTop: \"0\"\n    },\n    content: {}\n  };\n});\n\nvar _c;\n\n$RefreshReg$(_c, \"CheckoutCard\");","map":{"version":3,"sources":["/Users/petrhoskovec/Desktop/code/trip_map_staging/src/components/CheckoutCard/CheckoutCard.js"],"names":["React","useState","useEffect","jsx","Text","loadStripe","axios","toast","Lightbox","makeStyles","CircularProgress","CustomLoader","Card","CardContent","NextTabBtn","ProductSummary","getIsProduction","useGetDataPrintful","STRIPE_PUBLIC_KEY_LIVE","STRIPE_PUBLIC_KEY_TEST","Stripe","CheckoutCard","product","mapTitles","isUploadPending","setIsUploadPending","imageSavedResponse","imageBase64","backdropClose","percentageUpload","classes","useStyles","open","activeSrc","lightbox","setLightbox","variantId","dataPrintful","data","IS_PRODUCTION","STRIPE_API_KEY","asyncStripeInit","StripePromise","redirectToCheckout","post","imageObj","response","id","sessionId","paper","e","stopPropagation","styles","topStickyContainer","teaserWrapper","white_padding","teaserFinalImage","picture_description","color","subName","closeBackdrop","content","root","contentRoot","bottomCtaContainer","eval","price","shipping","rate","position","top","width","textAlign","zIndex","display","px","borderBottomLeftRadius","cursor","justifyContent","p","height","backgroundColor","alignItems","overflow","borderRadius","margin","boxShadow","right","pb","flexDirection","fontSize","productName","fontWeight","productSize","productDesc","bottom","py","theme","backdrop","minWidth","maxHeight","paddingTop"],"mappings":"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","sourcesContent":["/** @jsx jsx */\nimport React, { useState, useEffect } from \"react\";\nimport { jsx, Text } from \"theme-ui\";\nimport { loadStripe } from \"@stripe/stripe-js\";\n\nimport axios from \"axios\";\nimport { toast } from \"react-toastify\";\n\nimport Lightbox from \"react-image-lightbox\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport CircularProgress from \"@material-ui/core/CircularProgress\";\nimport CustomLoader from \"../CustomLoader\";\nimport Card from \"@material-ui/core/Card\";\nimport CardContent from \"@material-ui/core/CardContent\";\n\nimport NextTabBtn from \"../NextTabBtn/NextTabBtn\";\nimport ProductSummary from \"./ProductSummary\";\n\nimport { getIsProduction } from \"../../Lib/getIsProduction\";\nimport { useGetDataPrintful } from \"../../Hooks/useGetDataPrintful\";\n\nconst STRIPE_PUBLIC_KEY_LIVE =\n  \"pk_live_51IUQiOKQWovk2rIh0SfKkGNuHSE5J7VY6LCJaijjYh7lmjb64h8fmHcYmYoINNCNMTC5sxdsUkwnWIePd2z6vqPH00BzD2UrRm\";\nconst STRIPE_PUBLIC_KEY_TEST =\n  \"pk_test_51IUQiOKQWovk2rIhec8u6qPLKq2TgWI9ZLLkC4jJGIfnV9RV3gi1I5Vk2wmZfRWGCIunxtJgRcBZC8wDBOIstdLL00zZVirE5R\";\n\nlet Stripe;\n\nexport default function CheckoutCard({\n  product,\n  mapTitles,\n  isUploadPending,\n  setIsUploadPending,\n  imageSavedResponse,\n  imageBase64,\n  backdropClose,\n  percentageUpload,\n}) {\n  const classes = useStyles();\n  const [lightbox, setLightbox] = useState({ open: false, activeSrc: null });\n\n  const { data: dataPrintful } = useGetDataPrintful([product.variantId]);\n\n  const IS_PRODUCTION = getIsProduction();\n  const STRIPE_API_KEY = IS_PRODUCTION\n    ? STRIPE_PUBLIC_KEY_LIVE\n    : STRIPE_PUBLIC_KEY_TEST;\n\n  useEffect(() => {\n    const asyncStripeInit = async () => {\n      Stripe = await StripePromise;\n    };\n\n    const StripePromise = loadStripe(STRIPE_API_KEY);\n\n    asyncStripeInit();\n  }, []);\n\n  async function redirectToCheckout() {\n    const response = await axios.post(\"api/stripe-checkout\", {\n      product,\n      imageObj: imageSavedResponse,\n    });\n\n    if (response?.data?.id) {\n      Stripe.redirectToCheckout({\n        sessionId: response.data.id,\n      });\n    }\n  }\n\n  return (\n    <Card\n      className={classes.paper}\n      elevation={3}\n      onClick={(e) => e.stopPropagation()}\n    >\n      <div sx={styles.topStickyContainer}>\n        <div sx={styles.teaserWrapper}>\n          <div sx={styles.white_padding}>\n            {isUploadPending ? (\n              // <CircularProgress style={{ color: \"primary\" }} />\n              <>\n                <CustomLoader />\n              </>\n            ) : (\n              <img\n                id=\"img_screen_shot\"\n                sx={styles.teaserFinalImage}\n                src={imageBase64}\n                onClick={(e) => {\n                  setLightbox({\n                    open: true,\n                    activeSrc: imageBase64,\n                  });\n                  e.stopPropagation();\n                }}\n              />\n            )}\n          </div>\n        </div>\n        <div sx={styles.picture_description}>\n          <p style={{ color: \"white\" }}> {percentageUpload} %</p>\n          <p sx={styles.subName}>\n            {isUploadPending\n              ? \"Ukládám design v tiskové kvalitě\"\n              : \"Výsledný design pro tisk (bez rámování)\"}\n          </p>\n        </div>\n        <div sx={styles.closeBackdrop}>\n          <p onClick={() => backdropClose()}>X</p>\n        </div>\n      </div>\n\n      <CardContent\n        className={classes.content}\n        classes={{\n          root: classes.contentRoot,\n        }}\n      >\n        <ProductSummary\n          product={product}\n          mapTitles={mapTitles}\n          dataPrintfulVariant={dataPrintful && dataPrintful[product.variantId]}\n          // shippingInfoObject={shippingInfoObject}\n          // isShippingInfoLoading={isShippingInfoLoading}\n        />\n      </CardContent>\n      <div sx={styles.bottomCtaContainer}>\n        <NextTabBtn\n          width=\"90%\"\n          onClick={() => redirectToCheckout()}\n          isLoadingOnClick\n          isDisabled={isUploadPending}\n          disabledText={\"Ukládám výsledný design\"}\n          price={\n            dataPrintful &&\n            eval(\n              `${dataPrintful[product.variantId]?.price} + ${\n                dataPrintful[product.variantId]?.shipping.rate\n              }`\n            )\n          } //TODO add big.js\n        >\n          Adresa doručení & platba\n        </NextTabBtn>\n      </div>\n      {lightbox.open && (\n        <Lightbox\n          mainSrc={lightbox.activeSrc}\n          onCloseRequest={() => setLightbox({ open: false })}\n        />\n      )}\n    </Card>\n  );\n}\n\nconst styles = {\n  topStickyContainer: {\n    position: \"sticky\",\n    top: 0,\n    width: \"100%\",\n    textAlign: \"right\",\n    color: \"white\",\n    zIndex: 10,\n    display: \"flex\",\n    width: \"100%\",\n    backgroundColor: \"primary\", // \"text_secondary\",\n    borderBottomLeftRadius: \"20px\",\n    borderBottomRightRadius: \"20px\",\n    justifyContent: \"flex-start\",\n    alignItems: \"flex-end\",\n    p: {\n      display: \"inline-block\",\n      px: \"0.3rem\",\n      borderBottomLeftRadius: \"0.4rem\",\n      cursor: \"pointer\",\n    },\n  },\n  teaserWrapper: {\n    // flexDirection: \"column\",\n    display: \"flex\",\n    justifyContent: \"flex-start\",\n    p: \"10px\",\n    height: \"100px\",\n    //\n  },\n  white_padding: {\n    backgroundColor: \"whitish_paper_blue\",\n    display: \"flex\",\n    justifyContent: \"center\",\n    alignItems: \"center\",\n    height: \"80px\",\n    width: \"80px\",\n    position: \"relative\",\n    overflow: \"hidden\",\n    borderRadius: \"10px\",\n  },\n  teaserFinalImage: {\n    height: \"80%\",\n    width: \"80%\",\n    zIndex: 10,\n    margin: \"auto\",\n    cursor: \"pointer\",\n    boxShadow: \"0px 0px 3px rgba(0, 0, 0, 0.56)\",\n  },\n  closeBackdrop: {\n    position: \"absolute\",\n    right: 0,\n    top: 0,\n    p: \"0.3rem\",\n  },\n  picture_description: {\n    pb: \"10px\",\n    display: \"flex\",\n    flexDirection: \"column\",\n    textAlign: \"left\",\n  },\n  subName: {\n    textAlign: \"left\",\n    fontSize: \"0.8rem\",\n  },\n  productName: {\n    fontWeight: 600,\n  },\n  productSize: {\n    color: \"grey\",\n  },\n  productDesc: {\n    color: \"grey\",\n  },\n  bottomCtaContainer: {\n    position: \"sticky\",\n    bottom: -1,\n    width: \"100%\",\n    py: \"0.6rem\",\n  },\n};\n\nconst useStyles = makeStyles((theme) => ({\n  backdrop: {\n    zIndex: 10,\n    color: \"#fff\",\n    position: \"relative\",\n  },\n  paper: {\n    minWidth: \"300px\",\n    maxHeight: \"85vh\",\n    overflow: \"scroll\",\n    backgroundColor: \"whitish_paper_blue\",\n  },\n  contentRoot: {\n    paddingTop: \"0\",\n  },\n  content: {},\n}));\n"]},"metadata":{},"sourceType":"module"}