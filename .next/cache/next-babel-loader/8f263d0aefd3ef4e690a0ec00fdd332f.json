{"ast":null,"code":"var __jsx = React.createElement;\n\n/** @jsx jsx */\nimport React, { useState, useEffect } from \"react\";\nimport { jsx, Text } from \"theme-ui\";\nimport { loadStripe } from \"@stripe/stripe-js\";\nimport axios from \"axios\";\nimport { toast } from \"react-toastify\";\nimport Lightbox from \"react-image-lightbox\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport CircularProgress from \"@material-ui/core/CircularProgress\";\nimport CustomLoader from \"../CustomLoader\";\nimport Card from \"@material-ui/core/Card\";\nimport CardContent from \"@material-ui/core/CardContent\";\nimport NextTabBtn from \"../NextTabBtn/NextTabBtn\";\nimport ProductSummary from \"./ProductSummary\";\nimport { getIsProduction } from \"../../Lib/getIsProduction\";\nimport { useGetDataPrintful } from \"../../Hooks/useGetDataPrintful\";\nconst STRIPE_PUBLIC_KEY_LIVE = \"pk_live_51IUQiOKQWovk2rIh0SfKkGNuHSE5J7VY6LCJaijjYh7lmjb64h8fmHcYmYoINNCNMTC5sxdsUkwnWIePd2z6vqPH00BzD2UrRm\";\nconst STRIPE_PUBLIC_KEY_TEST = \"pk_test_51IUQiOKQWovk2rIhec8u6qPLKq2TgWI9ZLLkC4jJGIfnV9RV3gi1I5Vk2wmZfRWGCIunxtJgRcBZC8wDBOIstdLL00zZVirE5R\";\nlet Stripe;\nexport default function CheckoutCard({\n  product,\n  mapTitles,\n  isUploadPending,\n  setIsUploadPending,\n  imageSavedResponse,\n  imageBase64,\n  backdropClose,\n  percentageUpload\n}) {\n  var _dataPrintful$product, _dataPrintful$product2;\n\n  const classes = useStyles();\n  const {\n    0: lightbox,\n    1: setLightbox\n  } = useState({\n    open: false,\n    activeSrc: null\n  });\n  const {\n    data: dataPrintful\n  } = useGetDataPrintful([product.variantId]);\n  const IS_PRODUCTION = getIsProduction();\n  const STRIPE_API_KEY = IS_PRODUCTION ? STRIPE_PUBLIC_KEY_LIVE : STRIPE_PUBLIC_KEY_TEST;\n  useEffect(() => {\n    const asyncStripeInit = async () => {\n      Stripe = await StripePromise;\n    };\n\n    const StripePromise = loadStripe(STRIPE_API_KEY);\n    asyncStripeInit();\n  }, []);\n\n  async function redirectToCheckout() {\n    var _response$data;\n\n    const response = await axios.post(\"api/stripe-checkout\", {\n      product,\n      imageObj: imageSavedResponse\n    });\n\n    if (response === null || response === void 0 ? void 0 : (_response$data = response.data) === null || _response$data === void 0 ? void 0 : _response$data.id) {\n      Stripe.redirectToCheckout({\n        sessionId: response.data.id\n      });\n    }\n  }\n\n  return jsx(Card, {\n    className: classes.paper,\n    elevation: 3,\n    onClick: e => e.stopPropagation()\n  }, jsx(\"div\", {\n    sx: styles.topStickyContainer\n  }, jsx(\"div\", {\n    sx: styles.teaserWrapper\n  }, jsx(\"div\", {\n    sx: styles.white_padding\n  }, isUploadPending ? // <CircularProgress style={{ color: \"primary\" }} />\n  jsx(React.Fragment, null, jsx(CustomLoader, null)) : jsx(\"img\", {\n    id: \"img_screen_shot\",\n    sx: styles.teaserFinalImage,\n    src: imageBase64,\n    onClick: e => {\n      setLightbox({\n        open: true,\n        activeSrc: imageBase64\n      });\n      e.stopPropagation();\n    }\n  }))), jsx(\"div\", {\n    sx: styles.picture_description\n  }, jsx(\"p\", {\n    style: {\n      color: \"white\"\n    }\n  }, \" \", percentageUpload, \" %\"), jsx(\"p\", {\n    sx: styles.subName\n  }, isUploadPending ? \"Ukládám design v tiskové kvalitě\" : \"Výsledný design pro tisk (bez rámování)\")), jsx(\"div\", {\n    sx: styles.closeBackdrop\n  }, jsx(\"p\", {\n    onClick: () => backdropClose()\n  }, \"X\"))), jsx(CardContent, {\n    className: classes.content,\n    classes: {\n      root: classes.contentRoot\n    }\n  }, jsx(ProductSummary, {\n    product: product,\n    mapTitles: mapTitles,\n    dataPrintfulVariant: dataPrintful && dataPrintful[product.variantId] // shippingInfoObject={shippingInfoObject}\n    // isShippingInfoLoading={isShippingInfoLoading}\n\n  })), jsx(\"div\", {\n    sx: styles.bottomCtaContainer\n  }, jsx(NextTabBtn, {\n    width: \"90%\",\n    onClick: () => redirectToCheckout(),\n    isLoadingOnClick: true,\n    isDisabled: isUploadPending,\n    disabledText: \"Ukládám výsledný design\",\n    price: dataPrintful && eval(`${(_dataPrintful$product = dataPrintful[product.variantId]) === null || _dataPrintful$product === void 0 ? void 0 : _dataPrintful$product.price} + ${(_dataPrintful$product2 = dataPrintful[product.variantId]) === null || _dataPrintful$product2 === void 0 ? void 0 : _dataPrintful$product2.shipping.rate}`) //TODO add big.js\n\n  }, \"Adresa doru\\u010Den\\xED & platba\")), lightbox.open && jsx(Lightbox, {\n    mainSrc: lightbox.activeSrc,\n    onCloseRequest: () => setLightbox({\n      open: false\n    })\n  }));\n}\nconst styles = {\n  topStickyContainer: {\n    position: \"sticky\",\n    top: 0,\n    width: \"100%\",\n    textAlign: \"right\",\n    color: \"white\",\n    zIndex: 10,\n    display: \"flex\",\n    width: \"100%\",\n    backgroundColor: \"primary\",\n    // \"text_secondary\",\n    borderBottomLeftRadius: \"20px\",\n    borderBottomRightRadius: \"20px\",\n    justifyContent: \"flex-start\",\n    alignItems: \"flex-end\",\n    p: {\n      display: \"inline-block\",\n      px: \"0.3rem\",\n      borderBottomLeftRadius: \"0.4rem\",\n      cursor: \"pointer\"\n    }\n  },\n  teaserWrapper: {\n    // flexDirection: \"column\",\n    display: \"flex\",\n    justifyContent: \"flex-start\",\n    p: \"10px\",\n    height: \"100px\" //\n\n  },\n  white_padding: {\n    backgroundColor: \"whitish_paper_blue\",\n    display: \"flex\",\n    justifyContent: \"center\",\n    alignItems: \"center\",\n    height: \"80px\",\n    width: \"80px\",\n    position: \"relative\",\n    overflow: \"hidden\",\n    borderRadius: \"10px\"\n  },\n  teaserFinalImage: {\n    height: \"80%\",\n    width: \"80%\",\n    zIndex: 10,\n    margin: \"auto\",\n    cursor: \"pointer\",\n    boxShadow: \"0px 0px 3px rgba(0, 0, 0, 0.56)\"\n  },\n  closeBackdrop: {\n    position: \"absolute\",\n    right: 0,\n    top: 0,\n    p: \"0.3rem\"\n  },\n  picture_description: {\n    pb: \"10px\",\n    display: \"flex\",\n    flexDirection: \"column\",\n    textAlign: \"left\"\n  },\n  subName: {\n    textAlign: \"left\",\n    fontSize: \"0.8rem\"\n  },\n  productName: {\n    fontWeight: 600\n  },\n  productSize: {\n    color: \"grey\"\n  },\n  productDesc: {\n    color: \"grey\"\n  },\n  bottomCtaContainer: {\n    position: \"sticky\",\n    bottom: -1,\n    width: \"100%\",\n    py: \"0.6rem\"\n  }\n};\nconst useStyles = makeStyles(theme => ({\n  backdrop: {\n    zIndex: 10,\n    color: \"#fff\",\n    position: \"relative\"\n  },\n  paper: {\n    minWidth: \"300px\",\n    maxHeight: \"85vh\",\n    overflow: \"scroll\",\n    backgroundColor: \"whitish_paper_blue\"\n  },\n  contentRoot: {\n    paddingTop: \"0\"\n  },\n  content: {}\n}));","map":{"version":3,"sources":["/Users/petrhoskovec/Desktop/code/trip_map_staging/src/components/CheckoutCard/CheckoutCard.js"],"names":["React","useState","useEffect","jsx","Text","loadStripe","axios","toast","Lightbox","makeStyles","CircularProgress","CustomLoader","Card","CardContent","NextTabBtn","ProductSummary","getIsProduction","useGetDataPrintful","STRIPE_PUBLIC_KEY_LIVE","STRIPE_PUBLIC_KEY_TEST","Stripe","CheckoutCard","product","mapTitles","isUploadPending","setIsUploadPending","imageSavedResponse","imageBase64","backdropClose","percentageUpload","classes","useStyles","lightbox","setLightbox","open","activeSrc","data","dataPrintful","variantId","IS_PRODUCTION","STRIPE_API_KEY","asyncStripeInit","StripePromise","redirectToCheckout","response","post","imageObj","id","sessionId","paper","e","stopPropagation","styles","topStickyContainer","teaserWrapper","white_padding","teaserFinalImage","picture_description","color","subName","closeBackdrop","content","root","contentRoot","bottomCtaContainer","eval","price","shipping","rate","position","top","width","textAlign","zIndex","display","backgroundColor","borderBottomLeftRadius","borderBottomRightRadius","justifyContent","alignItems","p","px","cursor","height","overflow","borderRadius","margin","boxShadow","right","pb","flexDirection","fontSize","productName","fontWeight","productSize","productDesc","bottom","py","theme","backdrop","minWidth","maxHeight","paddingTop"],"mappings":"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","sourcesContent":["/** @jsx jsx */\nimport React, { useState, useEffect } from \"react\";\nimport { jsx, Text } from \"theme-ui\";\nimport { loadStripe } from \"@stripe/stripe-js\";\n\nimport axios from \"axios\";\nimport { toast } from \"react-toastify\";\n\nimport Lightbox from \"react-image-lightbox\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport CircularProgress from \"@material-ui/core/CircularProgress\";\nimport CustomLoader from \"../CustomLoader\";\nimport Card from \"@material-ui/core/Card\";\nimport CardContent from \"@material-ui/core/CardContent\";\n\nimport NextTabBtn from \"../NextTabBtn/NextTabBtn\";\nimport ProductSummary from \"./ProductSummary\";\n\nimport { getIsProduction } from \"../../Lib/getIsProduction\";\nimport { useGetDataPrintful } from \"../../Hooks/useGetDataPrintful\";\n\nconst STRIPE_PUBLIC_KEY_LIVE =\n  \"pk_live_51IUQiOKQWovk2rIh0SfKkGNuHSE5J7VY6LCJaijjYh7lmjb64h8fmHcYmYoINNCNMTC5sxdsUkwnWIePd2z6vqPH00BzD2UrRm\";\nconst STRIPE_PUBLIC_KEY_TEST =\n  \"pk_test_51IUQiOKQWovk2rIhec8u6qPLKq2TgWI9ZLLkC4jJGIfnV9RV3gi1I5Vk2wmZfRWGCIunxtJgRcBZC8wDBOIstdLL00zZVirE5R\";\n\nlet Stripe;\n\nexport default function CheckoutCard({\n  product,\n  mapTitles,\n  isUploadPending,\n  setIsUploadPending,\n  imageSavedResponse,\n  imageBase64,\n  backdropClose,\n  percentageUpload,\n}) {\n  const classes = useStyles();\n  const [lightbox, setLightbox] = useState({ open: false, activeSrc: null });\n\n  const { data: dataPrintful } = useGetDataPrintful([product.variantId]);\n\n  const IS_PRODUCTION = getIsProduction();\n  const STRIPE_API_KEY = IS_PRODUCTION\n    ? STRIPE_PUBLIC_KEY_LIVE\n    : STRIPE_PUBLIC_KEY_TEST;\n\n  useEffect(() => {\n    const asyncStripeInit = async () => {\n      Stripe = await StripePromise;\n    };\n\n    const StripePromise = loadStripe(STRIPE_API_KEY);\n\n    asyncStripeInit();\n  }, []);\n\n  async function redirectToCheckout() {\n    const response = await axios.post(\"api/stripe-checkout\", {\n      product,\n      imageObj: imageSavedResponse,\n    });\n\n    if (response?.data?.id) {\n      Stripe.redirectToCheckout({\n        sessionId: response.data.id,\n      });\n    }\n  }\n\n  return (\n    <Card\n      className={classes.paper}\n      elevation={3}\n      onClick={(e) => e.stopPropagation()}\n    >\n      <div sx={styles.topStickyContainer}>\n        <div sx={styles.teaserWrapper}>\n          <div sx={styles.white_padding}>\n            {isUploadPending ? (\n              // <CircularProgress style={{ color: \"primary\" }} />\n              <>\n                <CustomLoader />\n              </>\n            ) : (\n              <img\n                id=\"img_screen_shot\"\n                sx={styles.teaserFinalImage}\n                src={imageBase64}\n                onClick={(e) => {\n                  setLightbox({\n                    open: true,\n                    activeSrc: imageBase64,\n                  });\n                  e.stopPropagation();\n                }}\n              />\n            )}\n          </div>\n        </div>\n        <div sx={styles.picture_description}>\n          <p style={{ color: \"white\" }}> {percentageUpload} %</p>\n          <p sx={styles.subName}>\n            {isUploadPending\n              ? \"Ukládám design v tiskové kvalitě\"\n              : \"Výsledný design pro tisk (bez rámování)\"}\n          </p>\n        </div>\n        <div sx={styles.closeBackdrop}>\n          <p onClick={() => backdropClose()}>X</p>\n        </div>\n      </div>\n\n      <CardContent\n        className={classes.content}\n        classes={{\n          root: classes.contentRoot,\n        }}\n      >\n        <ProductSummary\n          product={product}\n          mapTitles={mapTitles}\n          dataPrintfulVariant={dataPrintful && dataPrintful[product.variantId]}\n          // shippingInfoObject={shippingInfoObject}\n          // isShippingInfoLoading={isShippingInfoLoading}\n        />\n      </CardContent>\n      <div sx={styles.bottomCtaContainer}>\n        <NextTabBtn\n          width=\"90%\"\n          onClick={() => redirectToCheckout()}\n          isLoadingOnClick\n          isDisabled={isUploadPending}\n          disabledText={\"Ukládám výsledný design\"}\n          price={\n            dataPrintful &&\n            eval(\n              `${dataPrintful[product.variantId]?.price} + ${\n                dataPrintful[product.variantId]?.shipping.rate\n              }`\n            )\n          } //TODO add big.js\n        >\n          Adresa doručení & platba\n        </NextTabBtn>\n      </div>\n      {lightbox.open && (\n        <Lightbox\n          mainSrc={lightbox.activeSrc}\n          onCloseRequest={() => setLightbox({ open: false })}\n        />\n      )}\n    </Card>\n  );\n}\n\nconst styles = {\n  topStickyContainer: {\n    position: \"sticky\",\n    top: 0,\n    width: \"100%\",\n    textAlign: \"right\",\n    color: \"white\",\n    zIndex: 10,\n    display: \"flex\",\n    width: \"100%\",\n    backgroundColor: \"primary\", // \"text_secondary\",\n    borderBottomLeftRadius: \"20px\",\n    borderBottomRightRadius: \"20px\",\n    justifyContent: \"flex-start\",\n    alignItems: \"flex-end\",\n    p: {\n      display: \"inline-block\",\n      px: \"0.3rem\",\n      borderBottomLeftRadius: \"0.4rem\",\n      cursor: \"pointer\",\n    },\n  },\n  teaserWrapper: {\n    // flexDirection: \"column\",\n    display: \"flex\",\n    justifyContent: \"flex-start\",\n    p: \"10px\",\n    height: \"100px\",\n    //\n  },\n  white_padding: {\n    backgroundColor: \"whitish_paper_blue\",\n    display: \"flex\",\n    justifyContent: \"center\",\n    alignItems: \"center\",\n    height: \"80px\",\n    width: \"80px\",\n    position: \"relative\",\n    overflow: \"hidden\",\n    borderRadius: \"10px\",\n  },\n  teaserFinalImage: {\n    height: \"80%\",\n    width: \"80%\",\n    zIndex: 10,\n    margin: \"auto\",\n    cursor: \"pointer\",\n    boxShadow: \"0px 0px 3px rgba(0, 0, 0, 0.56)\",\n  },\n  closeBackdrop: {\n    position: \"absolute\",\n    right: 0,\n    top: 0,\n    p: \"0.3rem\",\n  },\n  picture_description: {\n    pb: \"10px\",\n    display: \"flex\",\n    flexDirection: \"column\",\n    textAlign: \"left\",\n  },\n  subName: {\n    textAlign: \"left\",\n    fontSize: \"0.8rem\",\n  },\n  productName: {\n    fontWeight: 600,\n  },\n  productSize: {\n    color: \"grey\",\n  },\n  productDesc: {\n    color: \"grey\",\n  },\n  bottomCtaContainer: {\n    position: \"sticky\",\n    bottom: -1,\n    width: \"100%\",\n    py: \"0.6rem\",\n  },\n};\n\nconst useStyles = makeStyles((theme) => ({\n  backdrop: {\n    zIndex: 10,\n    color: \"#fff\",\n    position: \"relative\",\n  },\n  paper: {\n    minWidth: \"300px\",\n    maxHeight: \"85vh\",\n    overflow: \"scroll\",\n    backgroundColor: \"whitish_paper_blue\",\n  },\n  contentRoot: {\n    paddingTop: \"0\",\n  },\n  content: {},\n}));\n"]},"metadata":{},"sourceType":"module"}