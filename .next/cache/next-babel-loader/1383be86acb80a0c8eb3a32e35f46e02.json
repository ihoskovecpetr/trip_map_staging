{"ast":null,"code":"import _taggedTemplateLiteral from \"@babel/runtime/helpers/esm/taggedTemplateLiteral\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\n\nvar _s = $RefreshSig$(),\n    _containerBox,\n    _templateObject;\n\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\n/** @jsx jsx */\nimport React, { useEffect, useState, useRef } from \"react\";\nimport { jsx, Container, Box } from \"theme-ui\";\nimport SetupColumn from \"components/Tabs/TabsRoot\";\nimport MapContainer from \"components/canvas/mapContainer\";\nimport mapboxgl from \"mapbox-gl\";\nimport axios from \"axios\";\nimport styled from \"styled-components\";\nimport produce from \"immer\";\nimport { useIsMobile } from \"../Hooks/useIsMobile\";\nimport { useElementDimensions } from \"../Hooks/useElementDimensions\";\nimport { drawLayout } from \"../Lib/drawLayout\";\nimport { prepareTextInput } from \"../Lib/prepareTextInput\";\nimport { getUpdatedMapSizes } from \"../Lib/getUpdatedMapSizes\";\nimport { getCenteringFrameWidth } from \"../Lib/getCenteringFrameWidth\";\nimport { getIsVariantFramed } from \"../Lib/getIsVariantFramed\";\nimport { getIsProduction } from \"../Lib/getIsProduction\";\nimport { getCurrentPixelRatio } from \"../Lib/getCurrentPixelRatio\";\nimport { useGetDataPrintful } from \"../Hooks/useGetDataPrintful\";\nimport { MAP_STYLES, MAP_STYLES_NAMES // PIXEL_RATIO,\n, LAYOUT_STYLE_NAMES, SIZES, VARIANTS_PRINTFUL } from \"../constants/constants\";\nvar map;\nvar layoutCanvas;\nvar frameDiv;\nvar inputWrap;\nvar headlineInput;\nvar subtitleInput;\nvar canvasMap;\nvar ctxMap;\nvar mapWrapper;\nvar CURRENT_PIXEL_RATIO;\nvar IS_PRODUCTION = getIsProduction();\n\nvar resizeLayout = function resizeLayout(_ref) {\n  var cvsFrame = _ref.cvsFrame,\n      cvsMap = _ref.cvsMap,\n      activeLayout = _ref.activeLayout,\n      product = _ref.product,\n      mapTitles = _ref.mapTitles;\n  Object.assign(cvsFrame.style, {\n    display: \"none\"\n  });\n  cvsFrame.setAttribute(\"width\", cvsMap.width);\n  cvsFrame.setAttribute(\"height\", cvsMap.height);\n  var ctxFrame = cvsFrame.getContext(\"2d\");\n  drawLayout(ctxFrame, {\n    width: cvsMap.width,\n    height: cvsMap.height,\n    activeLayout: activeLayout,\n    mapTitles: !IS_PRODUCTION && mapTitles,\n    frameWidthKoef: getIsVariantFramed(product.variantId).frameWidth,\n    product: product\n  });\n  Object.assign(cvsFrame.style, {\n    position: \"absolute\",\n    pointerEvents: \"none\",\n    display: \"block\",\n    width: \"\".concat(cvsMap.width / CURRENT_PIXEL_RATIO, \"px\"),\n    height: \"\".concat(cvsMap.height / CURRENT_PIXEL_RATIO, \"px\")\n  });\n};\n\nvar resizeFrameDiv = function resizeFrameDiv(_ref2) {\n  var productRef = _ref2.productRef,\n      baseLongSize = _ref2.baseLongSize,\n      mapWrapWrapHeight = _ref2.mapWrapWrapHeight,\n      mapWrapWrapWidth = _ref2.mapWrapWrapWidth;\n  var framedVariantObj = getIsVariantFramed(productRef.current.variantId);\n\n  var _getUpdatedMapSizes = getUpdatedMapSizes({\n    ratio: productRef.current.sizeObject.ratio,\n    mapWrapWrapHeight: mapWrapWrapHeight,\n    mapWrapWrapWidth: mapWrapWrapWidth\n  }),\n      updHeight = _getUpdatedMapSizes.updHeight,\n      updWidth = _getUpdatedMapSizes.updWidth;\n\n  if (framedVariantObj) {\n    var extraFrame = baseLongSize * framedVariantObj.frameOutsideKoef / CURRENT_PIXEL_RATIO;\n    Object.assign(frameDiv.style, {\n      position: \"absolute\",\n      pointerEvents: \"none\",\n      display: \"block\",\n      // top: `-${extraFrame}px`,\n      // left: `-${extraFrame}px`,\n      top: 0,\n      left: 0,\n      outline: \"\".concat(extraFrame + 0, \"px solid \").concat(framedVariantObj.frameColor),\n      width: \"\".concat(Math.floor(updWidth), \"px\"),\n      height: \"\".concat(Math.floor(updHeight), \"px\")\n    });\n  }\n};\n\nvar addZoom = function addZoom(map) {\n  return function () {\n    map.flyTo({\n      zoom: map.getZoom() + 1\n    });\n  };\n};\n\nvar subtractZoom = function subtractZoom(map) {\n  return function () {\n    map.flyTo({\n      zoom: map.getZoom() - 1\n    });\n  };\n};\n\nvar resizeInputs = function resizeInputs(_ref3) {\n  var mapTitles = _ref3.mapTitles,\n      saveTitlesValue = _ref3.saveTitlesValue,\n      mapHeight = _ref3.mapHeight,\n      mapWidth = _ref3.mapWidth,\n      layout = _ref3.layout;\n  prepareTextInput({\n    element: headlineInput,\n    name: \"heading\",\n    textSize: mapTitles.heading.size,\n    textValue: mapTitles.heading.text,\n    defaultText: \"New York City, NY\",\n    onClickFce: saveTitlesValue,\n    height: mapHeight,\n    width: mapWidth,\n    // padding: paddingWidth,\n    // textAlign,\n    layout: layout\n  });\n  prepareTextInput({\n    element: subtitleInput,\n    name: \"subtitle\",\n    textSize: mapTitles.subtitle.size,\n    textValue: mapTitles.subtitle.text,\n    defaultText: \"léto 2021\",\n    // color: \"grey\",\n    onClickFce: saveTitlesValue,\n    height: mapHeight,\n    width: mapWidth,\n    // padding: paddingWidth,\n    // textAlign,\n    layout: layout\n  });\n};\n\nvar resizeInputsWrap = function resizeInputsWrap(_ref4) {\n  var productRef = _ref4.productRef,\n      layout = _ref4.layout,\n      canvasMap = _ref4.canvasMap;\n\n  var _getCenteringFrameWid = getCenteringFrameWidth({\n    variantId: productRef.current.variantId,\n    layout: layout,\n    elWidth: canvasMap === null || canvasMap === void 0 ? void 0 : canvasMap.width,\n    elHeight: canvasMap === null || canvasMap === void 0 ? void 0 : canvasMap.height\n  }),\n      paddingWidth = _getCenteringFrameWid.paddingWidth,\n      bottomBannerHeight = _getCenteringFrameWid.bottomBannerHeight;\n\n  Object.assign(inputWrap.style, {\n    width: \"100%\",\n    height: bottomBannerHeight + \"px\",\n    // `${frameCanvas.height}px`,\n    marginBottom: paddingWidth + \"px\",\n    display: \"flex\",\n    flexDirection: \"column\",\n    alignItems: \"stretch\",\n    justifyContent: \"center\",\n    position: \"absolute\",\n    bottom: 0\n  });\n};\n\nexport default function RootContainer() {\n  _s();\n\n  var _canvasMap, _canvasMap2;\n\n  var _useState = useState([-73.985542, 40.7484665]),\n      mapCoordinates = _useState[0],\n      setMapCoordinates = _useState[1];\n\n  var _useState2 = useState(10),\n      mapZoom = _useState2[0],\n      setMapZoom = _useState2[1];\n\n  var _useGetDataPrintful = useGetDataPrintful(),\n      dataPrintful = _useGetDataPrintful.data;\n\n  console.log({\n    dataPrintful_setProd: dataPrintful\n  });\n\n  var _useState3 = useState({\n    name: \"Zakázková mapa dle vlastního designu\",\n    price: null,\n    currency: \"CZK\",\n    sizeObject: SIZES.find(function (size) {\n      return size.code === VARIANTS_PRINTFUL[1].sizeName;\n    }),\n    variantId: VARIANTS_PRINTFUL[1].id,\n    materialDesc: \"Matný vylepšený papír\",\n    shippingCode: VARIANTS_PRINTFUL[1].shipping.codeCZ\n  }),\n      product = _useState3[0],\n      setProduct = _useState3[1];\n\n  var _useState4 = useState(LAYOUT_STYLE_NAMES.ISLAND_BOX),\n      layout = _useState4[0],\n      setLayout = _useState4[1];\n\n  var _useState5 = useState(MAP_STYLES_NAMES.WHITE_GREY),\n      activeMapStyle = _useState5[0],\n      setActiveMapStyle = _useState5[1];\n\n  var _useState6 = useState({\n    heading: {\n      text: false,\n      size: 14\n    },\n    subtitle: {\n      text: false,\n      size: 8\n    }\n  }),\n      mapTitles = _useState6[0],\n      setMapTitles = _useState6[1];\n\n  var _useElementDimensions = useElementDimensions(\"header\"),\n      headerHeight = _useElementDimensions.height;\n\n  var _useElementDimensions2 = useElementDimensions(\"map_wrapper_wrapper_id\"),\n      mapWrapWrapHeight = _useElementDimensions2.height,\n      mapWrapWrapWidth = _useElementDimensions2.width;\n\n  CURRENT_PIXEL_RATIO = getCurrentPixelRatio(product.variantId);\n\n  var _useIsMobile = useIsMobile(),\n      isMobile = _useIsMobile.isMobile;\n\n  var mapTitlesRef = useRef(mapTitles); // Using this due to snapshot state of state in hooks\n\n  var layoutRef = useRef(layout);\n  var coordinatesRef = useRef(mapCoordinates);\n  var productRef = useRef(product);\n  var isMobileRef = useRef(isMobile);\n  var wrapperSizeRef = useRef({\n    height: mapWrapWrapHeight,\n    width: mapWrapWrapWidth\n  });\n\n  var _getCenteringFrameWid2 = getCenteringFrameWidth({\n    variantId: productRef.current.variantId,\n    layout: layout,\n    elWidth: (_canvasMap = canvasMap) === null || _canvasMap === void 0 ? void 0 : _canvasMap.width,\n    elHeight: (_canvasMap2 = canvasMap) === null || _canvasMap2 === void 0 ? void 0 : _canvasMap2.height\n  }),\n      paddingWidth = _getCenteringFrameWid2.paddingWidth,\n      bottomBannerHeight = _getCenteringFrameWid2.bottomBannerHeight,\n      layoutObj = _getCenteringFrameWid2.layoutObj,\n      baseLongSize = _getCenteringFrameWid2.baseLongSize;\n\n  useEffect(function () {\n    Object.defineProperty(window, \"devicePixelRatio\", {\n      get: function get() {\n        return CURRENT_PIXEL_RATIO; // x / 96;\n      }\n    }); // const getAndSetPrice = async () => {\n    //   const response = await axios.post(`api/data-printful`, {\n    //     variantIdsArr: [product.variantId],\n    //   });\n    //   setProduct((prev) => ({\n    //     ...prev,\n    //     price: response.data.finalResult[product.variantId].price,\n    //   }));\n    // };\n    // getAndSetPrice();\n  }, []);\n  useEffect(function () {\n    var _dataPrintful$product;\n\n    if (dataPrintful && ((_dataPrintful$product = dataPrintful[product.variantId]) === null || _dataPrintful$product === void 0 ? void 0 : _dataPrintful$product.price)) {\n      var _dataPrintful$product2;\n\n      console.log(\"Root_set_price: \", (_dataPrintful$product2 = dataPrintful[product.variantId]) === null || _dataPrintful$product2 === void 0 ? void 0 : _dataPrintful$product2.price);\n      setProduct(function (prev) {\n        return _objectSpread({}, prev);\n      });\n    }\n  }, [mapTitles]);\n  useEffect(function () {\n    mapTitlesRef.current = mapTitles;\n  }, [mapTitles]);\n  useEffect(function () {\n    layoutRef.current = layout;\n  }, [layout]);\n  useEffect(function () {\n    coordinatesRef.current = mapCoordinates;\n  }, [mapCoordinates]);\n  useEffect(function () {\n    productRef.current = product;\n  }, [product]);\n  useEffect(function () {\n    isMobileRef.current = isMobile;\n  }, [isMobile]);\n  useEffect(function () {\n    wrapperSizeRef.current = {\n      height: mapWrapWrapHeight,\n      width: mapWrapWrapWidth\n    };\n  }, [mapWrapWrapHeight, mapWrapWrapWidth]);\n  useEffect(function () {\n    layoutRef.current = layout;\n\n    if (layoutCanvas && canvasMap) {\n      resizeLayout({\n        cvsFrame: layoutCanvas,\n        cvsMap: canvasMap,\n        activeLayout: layout,\n        mapTitles: mapTitlesRef.current,\n        product: productRef.current\n      });\n      resizeFrameDiv({\n        productRef: productRef,\n        baseLongSize: baseLongSize,\n        mapWrapWrapHeight: wrapperSizeRef.current.height,\n        mapWrapWrapWidth: wrapperSizeRef.current.width\n      });\n    }\n  }, [layout, product, isMobile, mapWrapWrapHeight, mapWrapWrapWidth]);\n  useEffect(function () {\n    mapboxgl.accessToken = \"pk.eyJ1IjoicGV0cmhvc2tvdmVjIiwiYSI6ImNrbHY2ZXY5eDJuaGkyb24xMXpzOHY2cXAifQ.g7wKRkK7WFwczUmDOYwCtQ\";\n    map = new mapboxgl.Map({\n      container: \"map\",\n      zoom: mapZoom,\n      minZoom: 0,\n      center: coordinatesRef.current,\n      style: MAP_STYLES[activeMapStyle],\n      preserveDrawingBuffer: true\n    });\n    return function () {\n      map.remove();\n    };\n  }, [activeMapStyle]);\n  useEffect(function () {\n    if (map) {\n      var _getUpdatedMapSizes2 = getUpdatedMapSizes({\n        ratio: productRef.current.sizeObject.ratio,\n        mapWrapWrapHeight: wrapperSizeRef.current.height,\n        mapWrapWrapWidth: wrapperSizeRef.current.width\n      }),\n          updHeight = _getUpdatedMapSizes2.updHeight,\n          updWidth = _getUpdatedMapSizes2.updWidth;\n\n      canvasMap = map.getCanvas();\n      ctxMap = canvasMap.getContext(\"webgl\");\n      var mapElement = document.getElementById(\"map\");\n      var existingLayoutCanvas = document.getElementById(\"layout_canvas\");\n\n      if (existingLayoutCanvas) {\n        existingLayoutCanvas.parentNode.removeChild(existingLayoutCanvas);\n      }\n\n      frameDiv = document.createElement(\"div\");\n      frameDiv.setAttribute(\"id\", \"frame_div\");\n      inputWrap = document.createElement(\"div\");\n      inputWrap.setAttribute(\"id\", \"input_wrap\");\n      resizeInputsWrap({\n        productRef: productRef,\n        layout: layout,\n        canvasMap: canvasMap\n      });\n      headlineInput = document.createElement(\"input\");\n      subtitleInput = document.createElement(\"input\");\n      map.on(\"moveend\", function () {\n        setMapCoordinates(map.getCenter());\n      });\n      layoutCanvas = document.createElement(\"canvas\");\n      layoutCanvas.setAttribute(\"id\", \"layout_canvas\");\n      map.on(\"load\", function () {\n        resizeLayout({\n          cvsFrame: layoutCanvas,\n          cvsMap: canvasMap,\n          activeLayout: layoutRef.current,\n          mapTitles: mapTitlesRef.current,\n          product: productRef.current\n        });\n        resizeInputs({\n          mapTitles: mapTitles,\n          saveTitlesValue: saveTitlesValue,\n          mapHeight: updHeight,\n          mapWidth: updWidth,\n          layout: layoutRef.current,\n          layoutObj: layoutObj,\n          paddingWidth: paddingWidth\n        });\n        mapElement.appendChild(frameDiv);\n        mapElement.appendChild(layoutCanvas);\n        mapElement.appendChild(inputWrap);\n        resizeInputsWrap({\n          productRef: productRef,\n          layout: layout,\n          canvasMap: canvasMap\n        });\n        inputWrap.appendChild(headlineInput);\n        inputWrap.appendChild(subtitleInput);\n      });\n      map.on(\"resize\", function () {\n        resizeLayout({\n          cvsFrame: layoutCanvas,\n          cvsMap: canvasMap,\n          activeLayout: layoutRef.current,\n          mapTitles: mapTitlesRef.current,\n          product: productRef.current\n        });\n        resizeFrameDiv({\n          productRef: productRef,\n          baseLongSize: baseLongSize,\n          mapWrapWrapHeight: wrapperSizeRef.current.height,\n          mapWrapWrapWidth: wrapperSizeRef.current.width\n        });\n      });\n      map.on(\"zoomend\", function (e) {\n        setMapZoom(e.target.getZoom());\n      });\n\n      if (map) {\n        map.resize();\n      }\n    }\n\n    return function () {\n      frameDiv.remove();\n      inputWrap.remove();\n      headlineInput.remove();\n      subtitleInput.remove();\n    };\n  }, [map, activeMapStyle]);\n  useEffect(function () {\n    mapWrapper = document.getElementById(\"map_wrapper_id\");\n\n    var _getUpdatedMapSizes3 = getUpdatedMapSizes({\n      ratio: productRef.current.sizeObject.ratio,\n      mapWrapWrapHeight: wrapperSizeRef.current.height,\n      mapWrapWrapWidth: wrapperSizeRef.current.width\n    }),\n        updHeight = _getUpdatedMapSizes3.updHeight,\n        updWidth = _getUpdatedMapSizes3.updWidth;\n\n    Object.assign(mapWrapper.style, {\n      height: \"\".concat(updHeight, \"px\"),\n      width: \"\".concat(updWidth, \"px\")\n    }); // const mapPlayground = document.getElementById(\"map_playground_wrap\");\n    // Object.assign(mapPlayground.style, {\n    //   height: `${(updHeight * 1, 5)}px`,\n    // });\n\n    if (map) {\n      map.resize();\n    }\n  }, [product, map, mapWrapWrapHeight, mapWrapWrapWidth]);\n  useEffect(function () {\n    if (headlineInput && subtitleInput) {\n      var _getUpdatedMapSizes4 = getUpdatedMapSizes({\n        ratio: productRef.current.sizeObject.ratio,\n        mapWrapWrapHeight: wrapperSizeRef.current.height,\n        mapWrapWrapWidth: wrapperSizeRef.current.width\n      }),\n          updHeight = _getUpdatedMapSizes4.updHeight,\n          updWidth = _getUpdatedMapSizes4.updWidth;\n\n      console.log({\n        updHeight4: updHeight\n      });\n      resizeInputsWrap({\n        productRef: productRef,\n        layout: layout,\n        canvasMap: canvasMap\n      });\n      resizeInputs({\n        mapTitles: mapTitles,\n        saveTitlesValue: saveTitlesValue,\n        mapHeight: updHeight,\n        mapWidth: updWidth,\n        layout: layout,\n        layoutObj: layoutObj,\n        paddingWidth: paddingWidth\n      });\n    }\n  }, [product, layout, mapWrapWrapHeight, mapWrapWrapWidth]);\n\n  var saveTitlesValue = function saveTitlesValue(e) {\n    setMapTitles(function (prev) {\n      return produce(prev, function (draftState) {\n        var _e$target$value;\n\n        var newValue = (_e$target$value = e.target.value) !== null && _e$target$value !== void 0 ? _e$target$value : \"\"; // ?.toUpperCase()\n\n        console.log({\n          newValue: newValue\n        });\n        draftState[e.target.name].text = newValue;\n      });\n    });\n  };\n\n  return jsx(\"section\", {\n    sx: {\n      marginTop: headerHeight\n    }\n  }, jsx(ContainerBox, {\n    headerHeight: headerHeight\n  }, jsx(\"div\", {\n    sx: styles.containerBox\n  }, jsx(Box, {\n    sx: styles.canvasBox,\n    id: \"map_playground_wrap\"\n  }, jsx(MapContainer, {\n    addZoom: addZoom(map),\n    subtractZoom: subtractZoom(map),\n    setProduct: setProduct,\n    product: product\n  })), jsx(Box, {\n    sx: styles.settingsBox\n  }, jsx(SetupColumn, {\n    map: map,\n    activeFrame: layout,\n    setActiveLayout: setLayout,\n    activeMapStyle: activeMapStyle,\n    setActiveMapStyle: setActiveMapStyle,\n    mapCoordinates: mapCoordinates,\n    setMapCoordinates: setMapCoordinates,\n    mapTitles: mapTitles,\n    product: product,\n    setProduct: setProduct\n  })))));\n}\n\n_s(RootContainer, \"jt1t9CotANfpVjtug6WjGMDXnGk=\", false, function () {\n  return [useGetDataPrintful, useElementDimensions, useElementDimensions, useIsMobile];\n});\n\n_c = RootContainer;\nvar styles = {\n  containerBox: (_containerBox = {\n    display: \"flex\",\n    alignItems: \"center\",\n    justifyContent: \"space-between\"\n  }, _defineProperty(_containerBox, \"alignItems\", \"flex-start\"), _defineProperty(_containerBox, \"flexWrap\", [\"wrap\", null, null, \"nowrap\"]), _defineProperty(_containerBox, \"height\", \"100%\"), _containerBox),\n  canvasBox: {\n    // px: [0, null, \"40px\", 0],\n    order: [0, 0, 0, 2],\n    width: [\"100%\", \"100%\", \"100%\", \"60%\"],\n    height: [null, null, null, \"100%\"]\n  },\n  settingsBox: {\n    flexShrink: 1,\n    order: [1, 1, 1, 0],\n    px: [0, null, \"30px\", 0],\n    textAlign: [\"center\", null, \"right\", \"left\"],\n    width: [\"100%\", \"100%\", \"100%\", \"40%\"],\n    mx: \"auto\",\n    backgroundColor: \"background_secondary\",\n    pb: [\"30px\", null, null, 0],\n    \".description\": {\n      pr: [0, null, null, null, 4]\n    },\n    height: \"100%\"\n  }\n};\nvar ContainerBox = styled.div(_templateObject || (_templateObject = _taggedTemplateLiteral([\"\\n  height: \", \";\\n\"])), function (_ref5) {\n  var headerHeight = _ref5.headerHeight;\n  return \"calc(100vh - \".concat(headerHeight, \"px)\");\n});\n_c2 = ContainerBox;\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"RootContainer\");\n$RefreshReg$(_c2, \"ContainerBox\");","map":{"version":3,"sources":["/Users/petrhoskovec/Desktop/code/trip_map_staging/src/sections/rootContainer.js"],"names":["React","useEffect","useState","useRef","jsx","Container","Box","SetupColumn","MapContainer","mapboxgl","axios","styled","produce","useIsMobile","useElementDimensions","drawLayout","prepareTextInput","getUpdatedMapSizes","getCenteringFrameWidth","getIsVariantFramed","getIsProduction","getCurrentPixelRatio","useGetDataPrintful","MAP_STYLES","MAP_STYLES_NAMES","LAYOUT_STYLE_NAMES","SIZES","VARIANTS_PRINTFUL","map","layoutCanvas","frameDiv","inputWrap","headlineInput","subtitleInput","canvasMap","ctxMap","mapWrapper","CURRENT_PIXEL_RATIO","IS_PRODUCTION","resizeLayout","cvsFrame","cvsMap","activeLayout","product","mapTitles","Object","assign","style","display","setAttribute","width","height","ctxFrame","getContext","frameWidthKoef","variantId","frameWidth","position","pointerEvents","resizeFrameDiv","productRef","baseLongSize","mapWrapWrapHeight","mapWrapWrapWidth","framedVariantObj","current","ratio","sizeObject","updHeight","updWidth","extraFrame","frameOutsideKoef","top","left","outline","frameColor","Math","floor","addZoom","flyTo","zoom","getZoom","subtractZoom","resizeInputs","saveTitlesValue","mapHeight","mapWidth","layout","element","name","textSize","heading","size","textValue","text","defaultText","onClickFce","subtitle","resizeInputsWrap","elWidth","elHeight","paddingWidth","bottomBannerHeight","marginBottom","flexDirection","alignItems","justifyContent","bottom","RootContainer","mapCoordinates","setMapCoordinates","mapZoom","setMapZoom","dataPrintful","data","console","log","dataPrintful_setProd","price","currency","find","code","sizeName","id","materialDesc","shippingCode","shipping","codeCZ","setProduct","ISLAND_BOX","setLayout","WHITE_GREY","activeMapStyle","setActiveMapStyle","setMapTitles","headerHeight","isMobile","mapTitlesRef","layoutRef","coordinatesRef","isMobileRef","wrapperSizeRef","layoutObj","defineProperty","window","get","prev","accessToken","Map","container","minZoom","center","preserveDrawingBuffer","remove","getCanvas","mapElement","document","getElementById","existingLayoutCanvas","parentNode","removeChild","createElement","on","getCenter","appendChild","e","target","resize","updHeight4","draftState","newValue","value","marginTop","styles","containerBox","canvasBox","settingsBox","order","flexShrink","px","textAlign","mx","backgroundColor","pb","pr","ContainerBox","div"],"mappings":"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","sourcesContent":["/** @jsx jsx */\nimport React, { useEffect, useState, useRef } from \"react\";\nimport { jsx, Container, Box } from \"theme-ui\";\nimport SetupColumn from \"components/Tabs/TabsRoot\";\nimport MapContainer from \"components/canvas/mapContainer\";\nimport mapboxgl from \"mapbox-gl\";\nimport axios from \"axios\";\nimport styled from \"styled-components\";\nimport produce from \"immer\";\n\nimport { useIsMobile } from \"../Hooks/useIsMobile\";\nimport { useElementDimensions } from \"../Hooks/useElementDimensions\";\nimport { drawLayout } from \"../Lib/drawLayout\";\nimport { prepareTextInput } from \"../Lib/prepareTextInput\";\nimport { getUpdatedMapSizes } from \"../Lib/getUpdatedMapSizes\";\nimport { getCenteringFrameWidth } from \"../Lib/getCenteringFrameWidth\";\nimport { getIsVariantFramed } from \"../Lib/getIsVariantFramed\";\nimport { getIsProduction } from \"../Lib/getIsProduction\";\nimport { getCurrentPixelRatio } from \"../Lib/getCurrentPixelRatio\";\nimport { useGetDataPrintful } from \"../Hooks/useGetDataPrintful\";\n\nimport {\n  MAP_STYLES,\n  MAP_STYLES_NAMES,\n  // PIXEL_RATIO,\n  LAYOUT_STYLE_NAMES,\n  SIZES,\n  VARIANTS_PRINTFUL,\n} from \"../constants/constants\";\n\nlet map;\nlet layoutCanvas;\nlet frameDiv;\nlet inputWrap;\nlet headlineInput;\nlet subtitleInput;\n\nlet canvasMap;\nlet ctxMap;\nlet mapWrapper;\nlet CURRENT_PIXEL_RATIO;\n\nconst IS_PRODUCTION = getIsProduction();\n\nconst resizeLayout = ({\n  cvsFrame,\n  cvsMap,\n  activeLayout,\n  product,\n  mapTitles,\n}) => {\n  Object.assign(cvsFrame.style, {\n    display: \"none\",\n  });\n\n  cvsFrame.setAttribute(\"width\", cvsMap.width);\n  cvsFrame.setAttribute(\"height\", cvsMap.height);\n\n  var ctxFrame = cvsFrame.getContext(\"2d\");\n\n  drawLayout(ctxFrame, {\n    width: cvsMap.width,\n    height: cvsMap.height,\n    activeLayout,\n    mapTitles: !IS_PRODUCTION && mapTitles,\n    frameWidthKoef: getIsVariantFramed(product.variantId).frameWidth,\n    product,\n  });\n\n  Object.assign(cvsFrame.style, {\n    position: \"absolute\",\n    pointerEvents: \"none\",\n    display: \"block\",\n    width: `${cvsMap.width / CURRENT_PIXEL_RATIO}px`,\n    height: `${cvsMap.height / CURRENT_PIXEL_RATIO}px`,\n  });\n};\n\nconst resizeFrameDiv = ({\n  productRef,\n  baseLongSize,\n  mapWrapWrapHeight,\n  mapWrapWrapWidth,\n}) => {\n  const framedVariantObj = getIsVariantFramed(productRef.current.variantId);\n\n  const { updHeight, updWidth } = getUpdatedMapSizes({\n    ratio: productRef.current.sizeObject.ratio,\n    mapWrapWrapHeight,\n    mapWrapWrapWidth,\n  });\n\n  if (framedVariantObj) {\n    const extraFrame =\n      (baseLongSize * framedVariantObj.frameOutsideKoef) / CURRENT_PIXEL_RATIO;\n\n    Object.assign(frameDiv.style, {\n      position: \"absolute\",\n      pointerEvents: \"none\",\n      display: \"block\",\n      // top: `-${extraFrame}px`,\n      // left: `-${extraFrame}px`,\n      top: 0,\n      left: 0,\n      outline: `${extraFrame + 0}px solid ${framedVariantObj.frameColor}`,\n      width: `${Math.floor(updWidth)}px`,\n      height: `${Math.floor(updHeight)}px`,\n    });\n  }\n};\n\nconst addZoom = (map) => () => {\n  map.flyTo({ zoom: map.getZoom() + 1 });\n};\n\nconst subtractZoom = (map) => () => {\n  map.flyTo({ zoom: map.getZoom() - 1 });\n};\n\nconst resizeInputs = ({\n  mapTitles,\n  saveTitlesValue,\n  mapHeight,\n  mapWidth,\n  layout,\n}) => {\n  prepareTextInput({\n    element: headlineInput,\n    name: \"heading\",\n    textSize: mapTitles.heading.size,\n    textValue: mapTitles.heading.text,\n    defaultText: \"New York City, NY\",\n    onClickFce: saveTitlesValue,\n    height: mapHeight,\n    width: mapWidth,\n    // padding: paddingWidth,\n    // textAlign,\n    layout,\n  });\n  prepareTextInput({\n    element: subtitleInput,\n    name: \"subtitle\",\n    textSize: mapTitles.subtitle.size,\n    textValue: mapTitles.subtitle.text,\n    defaultText: \"léto 2021\",\n    // color: \"grey\",\n    onClickFce: saveTitlesValue,\n    height: mapHeight,\n    width: mapWidth,\n    // padding: paddingWidth,\n    // textAlign,\n    layout,\n  });\n};\n\nconst resizeInputsWrap = ({ productRef, layout, canvasMap }) => {\n  const { paddingWidth, bottomBannerHeight } = getCenteringFrameWidth({\n    variantId: productRef.current.variantId,\n    layout,\n    elWidth: canvasMap?.width,\n    elHeight: canvasMap?.height,\n  });\n\n  Object.assign(inputWrap.style, {\n    width: \"100%\",\n    height: bottomBannerHeight + \"px\", // `${frameCanvas.height}px`,\n    marginBottom: paddingWidth + \"px\",\n    display: \"flex\",\n    flexDirection: \"column\",\n    alignItems: \"stretch\",\n    justifyContent: \"center\",\n    position: \"absolute\",\n    bottom: 0,\n  });\n};\n\nexport default function RootContainer() {\n  const [mapCoordinates, setMapCoordinates] = useState([\n    -73.985542,\n    40.7484665,\n  ]);\n  const [mapZoom, setMapZoom] = useState(10);\n  const { data: dataPrintful } = useGetDataPrintful();\n\n  console.log({ dataPrintful_setProd: dataPrintful });\n  const [product, setProduct] = useState({\n    name: \"Zakázková mapa dle vlastního designu\",\n    price: null,\n    currency: \"CZK\",\n    sizeObject: SIZES.find(\n      (size) => size.code === VARIANTS_PRINTFUL[1].sizeName\n    ),\n    variantId: VARIANTS_PRINTFUL[1].id,\n    materialDesc: \"Matný vylepšený papír\",\n    shippingCode: VARIANTS_PRINTFUL[1].shipping.codeCZ,\n  });\n\n  const [layout, setLayout] = useState(LAYOUT_STYLE_NAMES.ISLAND_BOX);\n  const [activeMapStyle, setActiveMapStyle] = useState(\n    MAP_STYLES_NAMES.WHITE_GREY\n  );\n  const [mapTitles, setMapTitles] = useState({\n    heading: { text: false, size: 14 },\n    subtitle: { text: false, size: 8 },\n  });\n\n  const { height: headerHeight } = useElementDimensions(\"header\");\n  const {\n    height: mapWrapWrapHeight,\n    width: mapWrapWrapWidth,\n  } = useElementDimensions(\"map_wrapper_wrapper_id\");\n\n  CURRENT_PIXEL_RATIO = getCurrentPixelRatio(product.variantId);\n  const { isMobile } = useIsMobile();\n\n  const mapTitlesRef = useRef(mapTitles); // Using this due to snapshot state of state in hooks\n  const layoutRef = useRef(layout);\n  const coordinatesRef = useRef(mapCoordinates);\n  const productRef = useRef(product);\n  const isMobileRef = useRef(isMobile);\n  const wrapperSizeRef = useRef({\n    height: mapWrapWrapHeight,\n    width: mapWrapWrapWidth,\n  });\n\n  const {\n    paddingWidth,\n    bottomBannerHeight,\n    layoutObj,\n    baseLongSize,\n  } = getCenteringFrameWidth({\n    variantId: productRef.current.variantId,\n    layout,\n    elWidth: canvasMap?.width,\n    elHeight: canvasMap?.height,\n  });\n\n  useEffect(() => {\n    Object.defineProperty(window, \"devicePixelRatio\", {\n      get: function () {\n        return CURRENT_PIXEL_RATIO; // x / 96;\n      },\n    });\n\n    // const getAndSetPrice = async () => {\n    //   const response = await axios.post(`api/data-printful`, {\n    //     variantIdsArr: [product.variantId],\n    //   });\n\n    //   setProduct((prev) => ({\n    //     ...prev,\n    //     price: response.data.finalResult[product.variantId].price,\n    //   }));\n    // };\n\n    // getAndSetPrice();\n  }, []);\n\n  useEffect(() => {\n    if (dataPrintful && dataPrintful[product.variantId]?.price) {\n      console.log(\"Root_set_price: \", dataPrintful[product.variantId]?.price);\n      setProduct((prev) => ({\n        ...prev,\n        // price: response.data.finalResult[product.variantId].price,\n      }));\n    }\n  }, [mapTitles]);\n\n  useEffect(() => {\n    mapTitlesRef.current = mapTitles;\n  }, [mapTitles]);\n\n  useEffect(() => {\n    layoutRef.current = layout;\n  }, [layout]);\n\n  useEffect(() => {\n    coordinatesRef.current = mapCoordinates;\n  }, [mapCoordinates]);\n\n  useEffect(() => {\n    productRef.current = product;\n  }, [product]);\n\n  useEffect(() => {\n    isMobileRef.current = isMobile;\n  }, [isMobile]);\n\n  useEffect(() => {\n    wrapperSizeRef.current = {\n      height: mapWrapWrapHeight,\n      width: mapWrapWrapWidth,\n    };\n  }, [mapWrapWrapHeight, mapWrapWrapWidth]);\n\n  useEffect(() => {\n    layoutRef.current = layout;\n\n    if (layoutCanvas && canvasMap) {\n      resizeLayout({\n        cvsFrame: layoutCanvas,\n        cvsMap: canvasMap,\n        activeLayout: layout,\n        mapTitles: mapTitlesRef.current,\n        product: productRef.current,\n      });\n\n      resizeFrameDiv({\n        productRef,\n        baseLongSize,\n        mapWrapWrapHeight: wrapperSizeRef.current.height,\n        mapWrapWrapWidth: wrapperSizeRef.current.width,\n      });\n    }\n  }, [layout, product, isMobile, mapWrapWrapHeight, mapWrapWrapWidth]);\n\n  useEffect(() => {\n    mapboxgl.accessToken =\n      \"pk.eyJ1IjoicGV0cmhvc2tvdmVjIiwiYSI6ImNrbHY2ZXY5eDJuaGkyb24xMXpzOHY2cXAifQ.g7wKRkK7WFwczUmDOYwCtQ\";\n\n    map = new mapboxgl.Map({\n      container: \"map\",\n      zoom: mapZoom,\n      minZoom: 0,\n      center: coordinatesRef.current,\n      style: MAP_STYLES[activeMapStyle],\n      preserveDrawingBuffer: true,\n    });\n\n    return () => {\n      map.remove();\n    };\n  }, [activeMapStyle]);\n\n  useEffect(() => {\n    if (map) {\n      const { updHeight, updWidth } = getUpdatedMapSizes({\n        ratio: productRef.current.sizeObject.ratio,\n        mapWrapWrapHeight: wrapperSizeRef.current.height,\n        mapWrapWrapWidth: wrapperSizeRef.current.width,\n      });\n\n      canvasMap = map.getCanvas();\n      ctxMap = canvasMap.getContext(\"webgl\");\n      const mapElement = document.getElementById(\"map\");\n\n      const existingLayoutCanvas = document.getElementById(\"layout_canvas\");\n      if (existingLayoutCanvas) {\n        existingLayoutCanvas.parentNode.removeChild(existingLayoutCanvas);\n      }\n\n      frameDiv = document.createElement(\"div\");\n      frameDiv.setAttribute(\"id\", \"frame_div\");\n      inputWrap = document.createElement(\"div\");\n      inputWrap.setAttribute(\"id\", \"input_wrap\");\n\n      resizeInputsWrap({ productRef, layout, canvasMap });\n\n      headlineInput = document.createElement(\"input\");\n      subtitleInput = document.createElement(\"input\");\n\n      map.on(\"moveend\", function () {\n        setMapCoordinates(map.getCenter());\n      });\n\n      layoutCanvas = document.createElement(\"canvas\");\n      layoutCanvas.setAttribute(\"id\", \"layout_canvas\");\n\n      map.on(\"load\", function () {\n        resizeLayout({\n          cvsFrame: layoutCanvas,\n          cvsMap: canvasMap,\n          activeLayout: layoutRef.current,\n          mapTitles: mapTitlesRef.current,\n          product: productRef.current,\n        });\n\n        resizeInputs({\n          mapTitles,\n          saveTitlesValue,\n          mapHeight: updHeight,\n          mapWidth: updWidth,\n          layout: layoutRef.current,\n          layoutObj,\n          paddingWidth,\n        });\n\n        mapElement.appendChild(frameDiv);\n        mapElement.appendChild(layoutCanvas);\n        mapElement.appendChild(inputWrap);\n\n        resizeInputsWrap({ productRef, layout, canvasMap });\n\n        inputWrap.appendChild(headlineInput);\n        inputWrap.appendChild(subtitleInput);\n      });\n\n      map.on(\"resize\", () => {\n        resizeLayout({\n          cvsFrame: layoutCanvas,\n          cvsMap: canvasMap,\n          activeLayout: layoutRef.current,\n          mapTitles: mapTitlesRef.current,\n          product: productRef.current,\n        });\n\n        resizeFrameDiv({\n          productRef,\n          baseLongSize,\n          mapWrapWrapHeight: wrapperSizeRef.current.height,\n          mapWrapWrapWidth: wrapperSizeRef.current.width,\n        });\n      });\n\n      map.on(\"zoomend\", (e) => {\n        setMapZoom(e.target.getZoom());\n      });\n\n      if (map) {\n        map.resize();\n      }\n    }\n\n    return () => {\n      frameDiv.remove();\n      inputWrap.remove();\n      headlineInput.remove();\n      subtitleInput.remove();\n    };\n  }, [map, activeMapStyle]);\n\n  useEffect(() => {\n    mapWrapper = document.getElementById(\"map_wrapper_id\");\n\n    const { updHeight, updWidth } = getUpdatedMapSizes({\n      ratio: productRef.current.sizeObject.ratio,\n      mapWrapWrapHeight: wrapperSizeRef.current.height,\n      mapWrapWrapWidth: wrapperSizeRef.current.width,\n    });\n\n    Object.assign(mapWrapper.style, {\n      height: `${updHeight}px`,\n      width: `${updWidth}px`,\n    });\n\n    // const mapPlayground = document.getElementById(\"map_playground_wrap\");\n\n    // Object.assign(mapPlayground.style, {\n    //   height: `${(updHeight * 1, 5)}px`,\n    // });\n\n    if (map) {\n      map.resize();\n    }\n  }, [product, map, mapWrapWrapHeight, mapWrapWrapWidth]);\n\n  useEffect(() => {\n    if (headlineInput && subtitleInput) {\n      const { updHeight, updWidth } = getUpdatedMapSizes({\n        ratio: productRef.current.sizeObject.ratio,\n        mapWrapWrapHeight: wrapperSizeRef.current.height,\n        mapWrapWrapWidth: wrapperSizeRef.current.width,\n      });\n\n      console.log({ updHeight4: updHeight });\n\n      resizeInputsWrap({ productRef, layout, canvasMap });\n\n      resizeInputs({\n        mapTitles,\n        saveTitlesValue,\n        mapHeight: updHeight,\n        mapWidth: updWidth,\n        layout,\n        layoutObj,\n        paddingWidth,\n      });\n    }\n  }, [product, layout, mapWrapWrapHeight, mapWrapWrapWidth]);\n\n  const saveTitlesValue = (e) => {\n    setMapTitles((prev) =>\n      produce(prev, (draftState) => {\n        const newValue = e.target.value ?? \"\"; // ?.toUpperCase()\n        console.log({ newValue });\n        draftState[e.target.name].text = newValue;\n      })\n    );\n  };\n\n  return (\n    <section sx={{ marginTop: headerHeight }}>\n      <ContainerBox headerHeight={headerHeight}>\n        <div sx={styles.containerBox}>\n          <Box sx={styles.canvasBox} id=\"map_playground_wrap\">\n            <MapContainer\n              addZoom={addZoom(map)}\n              subtractZoom={subtractZoom(map)}\n              setProduct={setProduct}\n              product={product}\n            />\n          </Box>\n          <Box sx={styles.settingsBox}>\n            <SetupColumn\n              map={map}\n              activeFrame={layout}\n              setActiveLayout={setLayout}\n              activeMapStyle={activeMapStyle}\n              setActiveMapStyle={setActiveMapStyle}\n              mapCoordinates={mapCoordinates}\n              setMapCoordinates={setMapCoordinates}\n              mapTitles={mapTitles}\n              product={product}\n              setProduct={setProduct}\n            />\n          </Box>\n        </div>\n      </ContainerBox>\n    </section>\n  );\n}\n\nconst styles = {\n  containerBox: {\n    display: \"flex\",\n    alignItems: \"center\",\n    justifyContent: \"space-between\",\n    alignItems: \"flex-start\",\n    flexWrap: [\"wrap\", null, null, \"nowrap\"],\n    height: \"100%\",\n  },\n  canvasBox: {\n    // px: [0, null, \"40px\", 0],\n    order: [0, 0, 0, 2],\n    width: [\"100%\", \"100%\", \"100%\", \"60%\"],\n    height: [null, null, null, \"100%\"],\n  },\n  settingsBox: {\n    flexShrink: 1,\n    order: [1, 1, 1, 0],\n    px: [0, null, \"30px\", 0],\n    textAlign: [\"center\", null, \"right\", \"left\"],\n    width: [\"100%\", \"100%\", \"100%\", \"40%\"],\n    mx: \"auto\",\n    backgroundColor: \"background_secondary\",\n    pb: [\"30px\", null, null, 0],\n    \".description\": {\n      pr: [0, null, null, null, 4],\n    },\n    height: \"100%\",\n  },\n};\n\nconst ContainerBox = styled.div`\n  height: ${({ headerHeight }) => `calc(100vh - ${headerHeight}px)`};\n`;\n"]},"metadata":{},"sourceType":"module"}