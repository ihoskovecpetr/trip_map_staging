{"ast":null,"code":"function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nconst axios = require(\"axios\");\n\nconst Big = require(\"big.js\");\n\nconst {\n  getCurrencyRateToCZK\n} = require(\"./getCurrencyRateToCZK\");\n\nconst {\n  TAXES_KOEFICIENT,\n  MARKUP_KOEFICIENT,\n  VARIANTS_PRINTFUL\n} = require(\"../../../constants/constants\");\n\nconst getShippingRateCZ = async variantId => {\n  const axiosConfig = {\n    headers: {\n      Authorization: `Basic ${process.env.AUTH_KEY_PRINTFUL}`,\n      \"Access-Control-Allow-Origin\": \"*\"\n    }\n  };\n  const body = {\n    recipient: {\n      address1: \"Krasné\",\n      city: \"Tři Sekery\",\n      country_code: \"CZ\",\n      zip: 35301\n    },\n    items: [{\n      quantity: 1,\n      variant_id: variantId\n    }]\n  };\n  const response = await axios.post(`https://api.printful.com/shipping/rates`, body, axiosConfig);\n  const exchangeRateCZKEUR = await getCurrencyRateToCZK({\n    currency: \"EUR\"\n  });\n  const priceEUR = new Big(response.data.result[0].rate);\n  const priceCZK = priceEUR.times(exchangeRateCZKEUR).times(TAXES_KOEFICIENT).times(MARKUP_KOEFICIENT).div(10).add(1).round(0).times(10).toString();\n  const constantVariant = VARIANTS_PRINTFUL.find(variant => variant.id == variantId);\n  const constantVariantPrice = constantVariant === null || constantVariant === void 0 ? void 0 : constantVariant.shipping.price;\n\n  if (Number(constantVariantPrice) > Number(priceCZK)) {\n    console.log(\"✅ it is OK, shipping cost Printfull is in limit\");\n  } else {\n    console.log(\"❌ Btw. PROBLEM, shipping cost Printfull is too high\", constantVariantPrice, priceCZK, variantId, {\n      raw: response.data.result[0]\n    });\n  }\n\n  return _objectSpread(_objectSpread({}, response.data.result[0]), {}, {\n    rate: constantVariantPrice,\n    currency: \"CZK\",\n    variantId: variantId\n  });\n};\n\nmodule.exports = {\n  getShippingRateCZ\n};","map":{"version":3,"sources":["/Users/petrhoskovec/Desktop/code/trip_map_staging/src/pages/api/Lib/getShippingRateCZ.js"],"names":["axios","require","Big","getCurrencyRateToCZK","TAXES_KOEFICIENT","MARKUP_KOEFICIENT","VARIANTS_PRINTFUL","getShippingRateCZ","variantId","axiosConfig","headers","Authorization","process","env","AUTH_KEY_PRINTFUL","body","recipient","address1","city","country_code","zip","items","quantity","variant_id","response","post","exchangeRateCZKEUR","currency","priceEUR","data","result","rate","priceCZK","times","div","add","round","toString","constantVariant","find","variant","id","constantVariantPrice","shipping","price","Number","console","log","raw","module","exports"],"mappings":";;;;;;AAAA,MAAMA,KAAK,GAAGC,OAAO,CAAC,OAAD,CAArB;;AACA,MAAMC,GAAG,GAAGD,OAAO,CAAC,QAAD,CAAnB;;AAEA,MAAM;AAAEE,EAAAA;AAAF,IAA2BF,OAAO,CAAC,wBAAD,CAAxC;;AAEA,MAAM;AACJG,EAAAA,gBADI;AAEJC,EAAAA,iBAFI;AAGJC,EAAAA;AAHI,IAIFL,OAAO,CAAC,8BAAD,CAJX;;AAMA,MAAMM,iBAAiB,GAAG,MAAOC,SAAP,IAAqB;AAC7C,QAAMC,WAAW,GAAG;AAClBC,IAAAA,OAAO,EAAE;AACPC,MAAAA,aAAa,EAAG,SAAQC,OAAO,CAACC,GAAR,CAAYC,iBAAkB,EAD/C;AAEP,qCAA+B;AAFxB;AADS,GAApB;AAOA,QAAMC,IAAI,GAAG;AACXC,IAAAA,SAAS,EAAE;AACTC,MAAAA,QAAQ,EAAE,QADD;AAETC,MAAAA,IAAI,EAAE,YAFG;AAGTC,MAAAA,YAAY,EAAE,IAHL;AAITC,MAAAA,GAAG,EAAE;AAJI,KADA;AAOXC,IAAAA,KAAK,EAAE,CACL;AACEC,MAAAA,QAAQ,EAAE,CADZ;AAEEC,MAAAA,UAAU,EAAEf;AAFd,KADK;AAPI,GAAb;AAeA,QAAMgB,QAAQ,GAAG,MAAMxB,KAAK,CAACyB,IAAN,CACpB,yCADoB,EAErBV,IAFqB,EAGrBN,WAHqB,CAAvB;AAMA,QAAMiB,kBAAkB,GAAG,MAAMvB,oBAAoB,CAAC;AAAEwB,IAAAA,QAAQ,EAAE;AAAZ,GAAD,CAArD;AAEA,QAAMC,QAAQ,GAAG,IAAI1B,GAAJ,CAAQsB,QAAQ,CAACK,IAAT,CAAcC,MAAd,CAAqB,CAArB,EAAwBC,IAAhC,CAAjB;AACA,QAAMC,QAAQ,GAAGJ,QAAQ,CACtBK,KADc,CACRP,kBADQ,EAEdO,KAFc,CAER7B,gBAFQ,EAGd6B,KAHc,CAGR5B,iBAHQ,EAId6B,GAJc,CAIV,EAJU,EAKdC,GALc,CAKV,CALU,EAMdC,KANc,CAMR,CANQ,EAOdH,KAPc,CAOR,EAPQ,EAQdI,QARc,EAAjB;AAUA,QAAMC,eAAe,GAAGhC,iBAAiB,CAACiC,IAAlB,CACrBC,OAAD,IAAaA,OAAO,CAACC,EAAR,IAAcjC,SADL,CAAxB;AAIA,QAAMkC,oBAAoB,GAAGJ,eAAH,aAAGA,eAAH,uBAAGA,eAAe,CAAEK,QAAjB,CAA0BC,KAAvD;;AAEA,MAAIC,MAAM,CAACH,oBAAD,CAAN,GAA+BG,MAAM,CAACb,QAAD,CAAzC,EAAqD;AACnDc,IAAAA,OAAO,CAACC,GAAR,CAAY,iDAAZ;AACD,GAFD,MAEO;AACLD,IAAAA,OAAO,CAACC,GAAR,CACE,qDADF,EAEEL,oBAFF,EAGEV,QAHF,EAIExB,SAJF,EAKE;AAAEwC,MAAAA,GAAG,EAAExB,QAAQ,CAACK,IAAT,CAAcC,MAAd,CAAqB,CAArB;AAAP,KALF;AAOD;;AAED,yCACKN,QAAQ,CAACK,IAAT,CAAcC,MAAd,CAAqB,CAArB,CADL;AAEEC,IAAAA,IAAI,EAAEW,oBAFR;AAGEf,IAAAA,QAAQ,EAAE,KAHZ;AAIEnB,IAAAA,SAAS,EAAEA;AAJb;AAMD,CAlED;;AAoEAyC,MAAM,CAACC,OAAP,GAAiB;AACf3C,EAAAA;AADe,CAAjB","sourcesContent":["const axios = require(\"axios\");\nconst Big = require(\"big.js\");\n\nconst { getCurrencyRateToCZK } = require(\"./getCurrencyRateToCZK\");\n\nconst {\n  TAXES_KOEFICIENT,\n  MARKUP_KOEFICIENT,\n  VARIANTS_PRINTFUL,\n} = require(\"../../../constants/constants\");\n\nconst getShippingRateCZ = async (variantId) => {\n  const axiosConfig = {\n    headers: {\n      Authorization: `Basic ${process.env.AUTH_KEY_PRINTFUL}`,\n      \"Access-Control-Allow-Origin\": \"*\",\n    },\n  };\n\n  const body = {\n    recipient: {\n      address1: \"Krasné\",\n      city: \"Tři Sekery\",\n      country_code: \"CZ\",\n      zip: 35301,\n    },\n    items: [\n      {\n        quantity: 1,\n        variant_id: variantId,\n      },\n    ],\n  };\n\n  const response = await axios.post(\n    `https://api.printful.com/shipping/rates`,\n    body,\n    axiosConfig\n  );\n\n  const exchangeRateCZKEUR = await getCurrencyRateToCZK({ currency: \"EUR\" });\n\n  const priceEUR = new Big(response.data.result[0].rate);\n  const priceCZK = priceEUR\n    .times(exchangeRateCZKEUR)\n    .times(TAXES_KOEFICIENT)\n    .times(MARKUP_KOEFICIENT)\n    .div(10)\n    .add(1)\n    .round(0)\n    .times(10)\n    .toString();\n\n  const constantVariant = VARIANTS_PRINTFUL.find(\n    (variant) => variant.id == variantId\n  );\n\n  const constantVariantPrice = constantVariant?.shipping.price;\n\n  if (Number(constantVariantPrice) > Number(priceCZK)) {\n    console.log(\"✅ it is OK, shipping cost Printfull is in limit\");\n  } else {\n    console.log(\n      \"❌ Btw. PROBLEM, shipping cost Printfull is too high\",\n      constantVariantPrice,\n      priceCZK,\n      variantId,\n      { raw: response.data.result[0] }\n    );\n  }\n\n  return {\n    ...response.data.result[0],\n    rate: constantVariantPrice,\n    currency: \"CZK\",\n    variantId: variantId,\n  };\n};\n\nmodule.exports = {\n  getShippingRateCZ,\n};\n"]},"metadata":{},"sourceType":"script"}